(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2729],{64075:function(e,l,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/crms/contacts",function(){return t(60919)}])},60919:function(e,l,t){"use strict";t.r(l),t.d(l,{default:function(){return O}});var r=t(85893),n=t(67294),s=t(17288),a=t(80562),i=t(73812),c=t(31538),d=t(29630),o=t(79072),m=t(49837),u=t(59742),x=t(61953),h=t(91359),j=t(21609),f=t(98966),Z=t(94314),g=t(5464),C=t(30381),b=t.n(C),p=t(86501),N=t(1890),S=t(77745),w=t(95398),_=t(55343),y=t(67836),v=t(75084);let k=e=>{let{show:l,contact:t,init:i,onInit:c,onClose:d}=e,{user:o}=(0,s.a)(),[m,u]=(0,n.useState)({name:"",email:"",subject:"",message:""});return(0,n.useEffect)(()=>{let e=async()=>{if(Object.keys(t).length){let{data:e}=await g.Z.get("crms/contacts/".concat(t._id));c(!i),u(e)}};e()},[t]),(0,r.jsxs)(N.Z,{fullWidth:!0,maxWidth:"md",onClose:d,open:l,children:[(0,r.jsxs)(S.Z,{children:["Contact Mail",(0,r.jsx)(a.Z,{onClick:d,sx:{position:"absolute",right:18,top:18,color:"#aaa"},children:(0,r.jsx)(j.Z,{icon:"mdi:close"})})]}),(0,r.jsxs)(w.Z,{sx:{p:6},children:[(0,r.jsx)(_.Z,{fullWidth:!0,sx:{mt:3,mb:6},children:(0,r.jsx)(y.Z,{value:m.name,label:"Sender Name",readOnly:!0})}),(0,r.jsx)(_.Z,{fullWidth:!0,sx:{mb:6},children:(0,r.jsx)(y.Z,{value:m.email,rows:8,label:"Sender Email",readOnly:!0})}),(0,r.jsx)(_.Z,{fullWidth:!0,sx:{mb:6},children:(0,r.jsx)(y.Z,{value:m.subject,rows:8,label:"Subject",readOnly:!0})}),(0,r.jsx)(_.Z,{fullWidth:!0,sx:{mb:6},children:(0,r.jsx)(y.Z,{value:m.message,multiline:!0,rows:8,label:"Message",readOnly:!0})}),(0,r.jsx)(x.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:(0,r.jsx)(v.Z,{variant:"contained",color:"error",size:"large",startIcon:(0,r.jsx)(j.Z,{icon:"mdi:close"}),onClick:d,children:"Close"})})]})]})},E=e=>{let{row:l,onDelete:t}=e,[s,d]=(0,n.useState)(null),o=Boolean(s),m=e=>{e.stopPropagation(),d(e.currentTarget)},u=()=>{d(null)},x=()=>{t(l._id),u()};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.Z,{size:"small",onClick:m,children:(0,r.jsx)(j.Z,{icon:"mdi:dots-vertical"})}),(0,r.jsx)(i.Z,{keepMounted:!0,anchorEl:s,open:o,onClose:u,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{style:{minWidth:"8rem"}},children:(0,r.jsxs)(c.Z,{sx:{"& svg":{mr:2}},onClick:x,children:[(0,r.jsx)(j.Z,{icon:"mdi:delete-outline",fontSize:20})," Delete"]})})]})},M=()=>{let{user:e}=(0,s.a)(),[l,t]=(0,n.useState)([]),[a,i]=(0,n.useState)(!0),[c,j]=(0,n.useState)(""),[Z,C]=(0,n.useState)(10),[N,S]=(0,n.useState)(!1),[w,_]=(0,n.useState)([]),[y,v]=(0,n.useState)("");(0,n.useEffect)(()=>{let l=async()=>{let{data:l}=await g.Z.get("crms/contacts",{params:{userId:e._id,search:c}});_(l)};l(),"super_admin"===e.role||"admin"===e.role?t([{flex:3,field:"name",headerName:"Name",renderCell(e){let{row:l}=e;return(0,r.jsx)(d.Z,{children:l.name})}},{flex:6,field:"email",headerName:"Email",renderCell(e){let{row:l}=e;return(0,r.jsx)(d.Z,{children:l.email})}},{flex:4,field:"subject",headerName:"Subject",renderCell(e){let{row:l}=e;return(0,r.jsx)(d.Z,{children:l.subject})}},{flex:4,field:"message",headerName:"Message",renderCell(e){let{row:l}=e;return(0,r.jsx)(d.Z,{children:l.message})}},{flex:3,field:"createdAt",headerName:"Sent date",renderCell(e){let{row:l}=e;return(0,r.jsx)(d.Z,{children:b()(l.createdAt).format("YYYY.MM.DD HH:mm:ss")})}},{flex:1,field:"action",headerName:"Action",renderCell(e){let{row:l}=e;return(0,r.jsx)(E,{row:l,onDelete:O})}}]):t([{flex:4,field:"name",headerName:"Name",renderCell(e){let{row:l}=e;return(0,r.jsx)(d.Z,{children:l.name})}},{flex:6,field:"email",headerName:"Email",renderCell(e){let{row:l}=e;return(0,r.jsx)(d.Z,{children:l.email})}},{flex:6,field:"subject",headerName:"Subject",renderCell(e){let{row:l}=e;return(0,r.jsx)(d.Z,{children:l.subject})}},{flex:6,field:"message",headerName:"Message",renderCell(e){let{row:l}=e;return(0,r.jsx)(d.Z,{children:l.message})}},{flex:2,field:"createdAt",headerName:"Sent date",renderCell(e){let{row:l}=e;return(0,r.jsx)(d.Z,{children:b()(l.createdAt).format("YYYY.MM.DD HH:mm:ss")})}}])},[a]);let M=async e=>{let{row:l}=e;v(l),S(!0)},O=async e=>{let{data:l}=await g.Z.delete("crms/contacts/".concat(e));l.status?(p.Am.success(l.msg),i(!a)):p.Am.error(l.msg)};return(0,r.jsx)(o.ZP,{container:!0,spacing:6,children:(0,r.jsx)(o.ZP,{item:!0,xs:12,children:(0,r.jsxs)(m.Z,{children:[(0,r.jsx)(u.Z,{title:(0,r.jsx)(x.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:(0,r.jsx)(d.Z,{variant:"h5",children:"Contact Mails"})})}),(0,r.jsxs)(h.Z,{children:[(0,r.jsx)(x.Z,{children:(0,r.jsx)(f._,{autoHeight:!0,getRowId:e=>e._id,columns:l,rows:w,onRowClick:M,pageSize:Z,onPageSizeChange:e=>C(e)})}),(0,r.jsx)(k,{show:N,contact:y,init:a,onInit:i,onClose:()=>S(!1)})]})]})})})};M.getLayout=e=>(0,r.jsx)(Z.Z,{children:e});var O=M}},function(e){e.O(0,[4885,6284,8480,4583,8515,8259,7836,9072,9317,7985,4314,9774,2888,179],function(){return e(e.s=64075)}),_N_E=e.O()}]);