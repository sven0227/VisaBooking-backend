(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5937],{57702:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/crms/categories",function(){return s(19403)}])},19403:function(e,n,s){"use strict";s.r(n);var t=s(85893),r=s(67294),i=s(80562),o=s(73812),a=s(31538),l=s(79072),c=s(49837),d=s(59742),m=s(61953),x=s(29630),u=s(75084),h=s(91359),j=s(1890),Z=s(77745),g=s(95398),p=s(55343),f=s(67836),C=s(32631),y=s(21609),S=s(74231),v=s(47533),_=s(87536),w=s(5464),b=s(86501),k=s(98966),N=s(94314);let E=e=>{let{row:n,onEdit:s,onDelete:l}=e,[c,d]=(0,r.useState)(null),m=Boolean(c),x=e=>{d(e.currentTarget)},u=()=>{d(null)},h=()=>{s(n),u()},j=()=>{l(n._id),u()};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Z,{size:"small",onClick:x,children:(0,t.jsx)(y.Z,{icon:"mdi:dots-vertical"})}),(0,t.jsxs)(o.Z,{keepMounted:!0,anchorEl:c,open:m,onClose:u,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{style:{minWidth:"8rem"}},children:[(0,t.jsxs)(a.Z,{sx:{"& svg":{mr:2}},onClick:h,children:[(0,t.jsx)(y.Z,{icon:"mdi:pencil-outline",fontSize:20})," Edit"]}),(0,t.jsxs)(a.Z,{sx:{"& svg":{mr:2}},onClick:j,children:[(0,t.jsx)(y.Z,{icon:"mdi:delete-outline",fontSize:20})," Delete"]})]})]})},z=()=>{let[e,n]=(0,r.useState)(!0),[s,o]=(0,r.useState)(""),[a,N]=(0,r.useState)(10),[z,A]=(0,r.useState)([]),[I,P]=(0,r.useState)(!1),[W,T]=(0,r.useState)(!1),[O,R]=(0,r.useState)(!1),[X,B]=(0,r.useState)({}),[q,D]=(0,r.useState)(0),M={name:""},Q=S.Ry().shape({name:S.Z_().required()}),F=S.Ry().shape({name:S.Z_().required()}),{reset:H,control:L,handleSubmit:U,formState:{errors:G}}=(0,_.cI)({defaultValues:M,mode:"onChange",resolver:(0,v.X)(Q)}),{reset:J,control:K,handleSubmit:V,formState:{errors:Y}}=(0,_.cI)({defaultValues:M,mode:"onChange",resolver:(0,v.X)(F)});(0,r.useEffect)(()=>{let e=async()=>{let{data:e}=await w.Z.get("crms/categories");A(e)};e()},[e]);let $=e=>{let{id:n,row:s}=e},ee=async s=>{let{data:t}=await w.Z.post("crms/categories",s);t.status?(H(M),T(!1),n(!e),b.Am.success(t.msg)):b.Am.error(t.msg)},en=e=>{D(e._id),J({name:e.name}),R(!0)},es=async s=>{let{data:t}=await w.Z.put("crms/categories/".concat(q),s);t.status?(J(M),R(!1),n(!e),b.Am.success(t.msg)):b.Am.error(t.msg)},et=async s=>{let{data:t}=await w.Z.delete("crms/categories/".concat(s));t.status?(n(!e),b.Am.success(t.msg)):b.Am.error(t.msg)};return(0,t.jsx)(l.ZP,{container:!0,spacing:6,children:(0,t.jsxs)(l.ZP,{item:!0,xs:12,children:[(0,t.jsxs)(c.Z,{children:[(0,t.jsx)(d.Z,{title:(0,t.jsxs)(m.Z,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,t.jsx)(x.Z,{variant:"h5",children:"Category Management"}),(0,t.jsx)(u.Z,{variant:"contained",size:"small",startIcon:(0,t.jsx)(y.Z,{icon:"mdi:plus"}),onClick:()=>T(!0),children:"Add New"})]})}),(0,t.jsx)(h.Z,{children:(0,t.jsx)(k._,{autoHeight:!0,getRowId:e=>e._id,columns:[{flex:6,field:"name",headerName:"Name",renderCell(e){let{row:n}=e;return n.title}},{flex:1,field:"action",headerName:"Action",renderCell(e){let{row:n}=e;return(0,t.jsx)(E,{row:n,onEdit:en,onDelete:et})}}],rows:z,onRowClick:$,pageSize:a,onPageSizeChange:e=>N(e)})})]}),(0,t.jsxs)(j.Z,{fullWidth:!0,maxWidth:"sm",onClose:()=>T(!1),open:W,children:[(0,t.jsxs)(Z.Z,{children:["New Category",(0,t.jsx)(i.Z,{onClick:()=>T(!1),sx:{position:"absolute",right:18,top:18,color:"#aaa"},children:(0,t.jsx)(y.Z,{icon:"mdi:close"})})]}),(0,t.jsx)(g.Z,{sx:{p:6},children:(0,t.jsxs)("form",{onSubmit:U(ee),style:{paddingTop:8},children:[(0,t.jsxs)(p.Z,{fullWidth:!0,sx:{mb:6},children:[(0,t.jsx)(_.Qr,{name:"name",control:L,render(e){let{field:{value:n,onChange:s}}=e;return(0,t.jsx)(f.Z,{value:n,label:"Category Name",onChange:s,error:Boolean(G.name)})}}),G.name&&(0,t.jsx)(C.Z,{sx:{color:"error.main"},children:G.name.message})]}),(0,t.jsxs)(m.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:[(0,t.jsx)(u.Z,{type:"submit",variant:"contained",startIcon:(0,t.jsx)(y.Z,{icon:"mdi:content-save"}),sx:{mr:3},children:"Save"}),(0,t.jsx)(u.Z,{variant:"contained",color:"error",onClick:()=>T(!1),startIcon:(0,t.jsx)(y.Z,{icon:"mdi:close"}),children:"Cancel"})]})]})})]}),(0,t.jsxs)(j.Z,{fullWidth:!0,maxWidth:"sm",onClose:()=>R(!1),open:O,children:[(0,t.jsxs)(Z.Z,{children:["Edit Category",(0,t.jsx)(i.Z,{onClick:()=>R(!1),sx:{position:"absolute",right:18,top:18,color:"#aaa"},children:(0,t.jsx)(y.Z,{icon:"mdi:close"})})]}),(0,t.jsx)(g.Z,{sx:{p:6},children:(0,t.jsxs)("form",{onSubmit:V(es),style:{paddingTop:8},children:[(0,t.jsxs)(p.Z,{fullWidth:!0,sx:{mb:6},children:[(0,t.jsx)(_.Qr,{name:"name",control:K,render(e){let{field:{value:n,onChange:s}}=e;return(0,t.jsx)(f.Z,{value:n,label:"Category Name",onChange:s,error:Boolean(Y.name)})}}),Y.name&&(0,t.jsx)(C.Z,{sx:{color:"error.main"},children:Y.name.message})]}),(0,t.jsxs)(m.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:[(0,t.jsx)(u.Z,{type:"submit",variant:"contained",sx:{mr:3},startIcon:(0,t.jsx)(y.Z,{icon:"mdi:content-save"}),children:"Update"}),(0,t.jsx)(u.Z,{variant:"contained",color:"error",onClick:()=>R(!1),startIcon:(0,t.jsx)(y.Z,{icon:"mdi:close"}),children:"Cancel"})]})]})})]})]})})};z.getLayout=e=>(0,t.jsx)(N.Z,{children:e}),n.default=z}},function(e){e.O(0,[6284,8480,4583,8515,8259,7836,9072,9491,9317,7985,4314,9774,2888,179],function(){return e(e.s=57702)}),_N_E=e.O()}]);