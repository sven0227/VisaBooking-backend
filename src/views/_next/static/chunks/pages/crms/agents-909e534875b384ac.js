(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5158],{47386:function(e,r,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/crms/agents",function(){return s(82534)}])},82534:function(e,r,s){"use strict";s.r(r);var l=s(85893),a=s(67294),n=s(80562),i=s(73812),t=s(31538),o=s(29630),d=s(21448),c=s(79072),m=s(49837),x=s(59742),u=s(61953),h=s(67836),Z=s(75084),j=s(91359),g=s(1890),p=s(77745),f=s(95398),b=s(55343),C=s(32631),N=s(58316),y=s(53442),q=s(98966),v=s(21609),P=s(74231),W=s(47533),w=s(87536),_=s(94314),S=s(5464),k=s(86501);let B=e=>{let{id:r,status:s,permitAgent:o,editAgent:d,deleteAgent:c}=e,[m,x]=(0,a.useState)(null),u=Boolean(m),h=e=>{x(e.currentTarget)},Z=()=>{x(null)},j=()=>{o(r,s),Z()},g=()=>{d(r),Z()},p=()=>{c(r),Z()};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.Z,{size:"small",onClick:h,children:(0,l.jsx)(v.Z,{icon:"mdi:dots-vertical"})}),(0,l.jsxs)(i.Z,{keepMounted:!0,anchorEl:m,open:u,onClose:Z,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{style:{minWidth:"8rem"}},children:[s?(0,l.jsxs)(t.Z,{onClick:j,sx:{"& svg":{mr:2}},children:[(0,l.jsx)(v.Z,{icon:"mdi:account-lock",fontSize:20}),"Pause"]}):(0,l.jsxs)(t.Z,{onClick:j,sx:{"& svg":{mr:2}},children:[(0,l.jsx)(v.Z,{icon:"mdi:account-lock-open",fontSize:20}),"Allow"]}),(0,l.jsxs)(t.Z,{onClick:g,sx:{"& svg":{mr:2}},children:[(0,l.jsx)(v.Z,{icon:"mdi:pencil-outline",fontSize:20}),"Edit"]}),(0,l.jsxs)(t.Z,{onClick:p,sx:{"& svg":{mr:2}},children:[(0,l.jsx)(v.Z,{icon:"mdi:delete-outline",fontSize:20}),"Delete"]})]})]})},Q=()=>{let[e,r]=(0,a.useState)(!0),[s,i]=(0,a.useState)(""),[_,Q]=(0,a.useState)(10),[A,E]=(0,a.useState)([]),[z,I]=(0,a.useState)([]),[R,T]=(0,a.useState)(!1),[F,L]=(0,a.useState)(!1),[M,O]=(0,a.useState)(0),X={firstName:"",lastName:"",corpName:"",email:"",phone:"",address:"",category:"",balance:100,password:""},H=P.Ry().shape({firstName:P.Z_().required("First name is required field."),lastName:P.Z_().required("Last name is required field."),corpName:P.Z_().required("Company name is required field."),email:P.Z_().email("Email is invalid.").required("Email is required field."),category:P.Z_().required("Category is required field."),address:P.Z_().required("Address is required field."),phone:P.Z_().min(10,"Phone number must be at least 10 digits").required("Phone number is required field."),balance:P.Rx("Credit must be numeric").required("Credit is required field."),password:P.Z_().required("Password is required field.")}),D=P.Ry().shape({firstName:P.Z_().required("First name is required field."),lastName:P.Z_().required("Last name is required field."),corpName:P.Z_().required("Company name is required field."),email:P.Z_().email("Email is invalid.").required("Email is required field."),category:P.Z_().required("Category is required field."),address:P.Z_().required(10,"Address is required field."),phone:P.Z_().min(10,"Phone number must be at least 10 digits").required("Phone number is required"),balance:P.Rx("Credit must be numeric").required("Credit is required field.")});(0,a.useEffect)(()=>{let e=async()=>{let{data:e}=await S.Z.get("crms/categories");E(e)},r=async()=>{let{data:e}=await S.Z.get("crms/agents",{params:{search:""}});I(e)};e(),r()},[e,s,_]);let{reset:G,control:U,handleSubmit:J,formState:{errors:K}}=(0,w.cI)({defaultValues:X,mode:"onChange",resolver:(0,W.X)(H)}),{reset:V,control:Y,handleSubmit:$,formState:{errors:ee}}=(0,w.cI)({defaultValues:X,mode:"onChange",resolver:(0,W.X)(D)}),er=()=>{T(!0)},es=async s=>{let{data:l}=await S.Z.post("crms/agents",{...s,role:"agent"});l.status?(G(X),T(!1),r(!e),k.ZP.success(l.msg)):k.ZP.error(l.msg)},el=async e=>{O(e);let{data:r}=await S.Z.get("crms/agents/".concat(e));V({firstName:r.firstName,lastName:r.lastName,corpName:r.corpName,email:r.email,category:r.category,phone:r.phone,balance:r.balance,address:r.address,password:""}),L(!0)},ea=async(s,l)=>{let{data:a}=await S.Z.put("/crms/agents/".concat(s),{status:!l});a.status?(k.ZP.success(a.msg),r(!e)):k.ZP.error(a.msg)},en=async s=>{console.log(s);let{data:l}=await S.Z.put("crms/agents/".concat(M),s);l.status?(V(X),L(!1),r(!e),k.ZP.success(l.msg)):k.ZP.error(l.msg)},ei=async s=>{let{data:l}=await S.Z.delete("crms/agents/".concat(s));l.status?r(!e):k.ZP.error(l.msg)};return(0,l.jsxs)(c.ZP,{container:!0,spacing:6,children:[(0,l.jsx)(c.ZP,{item:!0,xs:12,children:(0,l.jsxs)(m.Z,{children:[(0,l.jsx)(x.Z,{title:(0,l.jsxs)(u.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(o.Z,{variant:"h5",children:"Agent Management"}),(0,l.jsx)(u.Z,{sx:{pl:0,pr:0,pt:0,pb:0,display:"flex",flex:1,flexWrap:"wrap",alignItems:"center",justifyContent:"flex-end"},children:(0,l.jsxs)(u.Z,{sx:{display:"flex",flexWrap:"wrap",alignItems:"center"},children:[(0,l.jsx)(h.Z,{size:"small",value:s,sx:{mr:6,mb:2},placeholder:"Search agent...",onChange:e=>i(e.target.value)}),(0,l.jsxs)(Z.Z,{sx:{mb:2},onClick:er,variant:"contained",children:[(0,l.jsx)(v.Z,{icon:"mdi:plus"})," Add agent"]})]})})]})}),(0,l.jsx)(j.Z,{children:(0,l.jsx)(q._,{autoHeight:!0,getRowId:e=>e._id,rows:z,columns:[{flex:.1,minWidth:140,field:"firstName",headerName:"First Name",renderCell(e){let{row:r}=e;return(0,l.jsx)(o.Z,{noWrap:!0,children:r.firstName})}},{flex:.1,minWidth:140,field:"lastName",headerName:"Last Name",renderCell(e){let{row:r}=e;return(0,l.jsx)(o.Z,{noWrap:!0,children:r.lastName})}},{flex:.1,minWidth:150,field:"corpName",headerName:"Company Name",renderCell(e){let{row:r}=e;return(0,l.jsx)(o.Z,{noWrap:!0,children:r.corpName})}},{flex:.3,minWidth:150,field:"email",headerName:"Email",renderCell(e){let{row:r}=e;return(0,l.jsx)(o.Z,{noWrap:!0,children:r.email})}},{flex:.1,minWidth:200,field:"phone",headerName:"Phone",renderCell(e){let{row:r}=e;return(0,l.jsx)(o.Z,{noWrap:!0,children:r.phone})}},{flex:.2,minWidth:300,field:"address",headerName:"Address",renderCell(e){let{row:r}=e;return(0,l.jsx)(o.Z,{noWrap:!0,children:r.address})}},{flex:.1,minWidth:100,field:"balance",headerName:"Credit",renderCell(e){let{row:r}=e;return(0,l.jsx)(o.Z,{noWrap:!0,children:r.balance})}},{flex:.1,minWidth:110,field:"status",headerName:"Status",renderCell(e){let{row:r}=e;return(0,l.jsx)(d.Z,{skin:"light",size:"small",variant:"filled",label:r.status?"Approved":"Refused",color:r.status?"success":"warning",sx:{textTransform:"capitalize","& .MuiChip-label":{lineHeight:"18px"}}})}},{flex:.1,sortable:!1,field:"actions",headerName:"Actions",renderCell(e){let{row:r}=e;return(0,l.jsx)(B,{id:r._id,status:r.status,permitAgent:ea,editAgent:el,deleteAgent:ei})}}],rowsPerPageOptions:[10,25,50],pageSize:_,sx:{"& .MuiDataGrid-columnHeaders":{borderRadius:0}},onPageSizeChange:e=>Q(e)})})]})}),(0,l.jsxs)(g.Z,{fullWidth:!0,maxWidth:"sm",onClose:()=>T(!1),open:R,children:[(0,l.jsxs)(p.Z,{children:["New Agent",(0,l.jsx)(n.Z,{onClick:()=>T(!1),sx:{position:"absolute",right:18,top:18,color:"#aaaaaa"},children:(0,l.jsx)(v.Z,{icon:"mdi:close"})})]}),(0,l.jsx)(f.Z,{sx:{p:6},children:(0,l.jsxs)("form",{onSubmit:J(es),style:{paddingTop:8},children:[(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"firstName",control:U,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{value:r,label:"First Name",onChange:s,error:Boolean(K.firstName)})}}),K.firstName&&(0,l.jsx)(C.Z,{sx:{color:"error.main"},children:K.firstName.message})]}),(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"lastName",control:U,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{value:r,label:"Last Name",onChange:s,error:Boolean(K.lastName)})}}),K.lastName&&(0,l.jsx)(C.Z,{sx:{color:"error.main"},children:K.lastName.message})]}),(0,l.jsxs)(c.ZP,{container:!0,spacing:6,children:[(0,l.jsx)(c.ZP,{item:!0,md:6,sm:12,children:(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"email",control:U,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"email",value:r,label:"Email",onChange:s,error:Boolean(K.email)})}}),K.email&&(0,l.jsx)(C.Z,{sx:{color:"error.main"},children:K.email.message})]})}),(0,l.jsx)(c.ZP,{item:!0,md:6,sm:12,children:(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"phone",control:U,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"string",label:"Phone",value:r,onChange:s,error:Boolean(K.phone)})}}),K.phone&&(0,l.jsx)(C.Z,{sx:{color:"error.main"},children:K.phone.message})]})})]}),(0,l.jsxs)(c.ZP,{container:!0,spacing:6,children:[(0,l.jsx)(c.ZP,{item:!0,md:6,sm:12,children:(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"corpName",control:U,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{value:r,label:"Corp Name",onChange:s,error:Boolean(K.corpName)})}}),K.corpName&&(0,l.jsx)(C.Z,{sx:{color:"error.main"},children:K.corpName.message})]})}),(0,l.jsx)(c.ZP,{item:!0,md:6,sm:12,children:(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"balance",control:U,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"number",value:r,label:"Credit",onChange:s,error:Boolean(K.balance)})}}),K.balance&&(0,l.jsx)(C.Z,{sx:{color:"error.main"},children:K.balance.message})]})}),(0,l.jsx)(c.ZP,{item:!0,md:6,sm:12,children:(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"address",control:U,render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{value:r,label:"Address",onChange:s,error:Boolean(K.address)})}}),K.address&&(0,l.jsx)(C.Z,{sx:{color:"error.main"},children:K.address.message})]})}),(0,l.jsx)(c.ZP,{item:!0,md:6,sm:12,children:(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(N.Z,{children:"Category"}),(0,l.jsx)(w.Qr,{name:"category",control:U,render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsxs)(y.Z,{value:r,label:"Category",onChange:s,error:Boolean(K.category),children:[(0,l.jsx)(t.Z,{value:"",children:"Please select"}),A.map((e,r)=>(0,l.jsx)(t.Z,{value:e._id,children:e.name},r))]})}}),K.category&&(0,l.jsx)(C.Z,{sx:{color:"error.main"},children:K.category.message})]})})]}),(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"password",control:U,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"text",label:"Password",value:r,onChange:s,error:Boolean(K.password)})}}),K.password&&(0,l.jsx)(C.Z,{sx:{color:"error.main"},children:K.password.message})]}),(0,l.jsxs)(u.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:[(0,l.jsx)(Z.Z,{type:"submit",variant:"contained",color:"primary",size:"large",startIcon:(0,l.jsx)(v.Z,{icon:"mdi:content-save"}),sx:{mr:4},children:"Save"}),(0,l.jsx)(Z.Z,{variant:"contained",color:"error",size:"large",startIcon:(0,l.jsx)(v.Z,{icon:"mdi:delete"}),onClick:()=>T(!1),children:"Cancel"})]})]})})]}),(0,l.jsxs)(g.Z,{fullWidth:!0,maxWidth:"sm",onClose:()=>L(!1),open:F,children:[(0,l.jsxs)(p.Z,{children:["Edit Agent",(0,l.jsx)(n.Z,{onClick:()=>L(!1),sx:{position:"absolute",right:18,top:18,color:"#aaaaaa"},children:(0,l.jsx)(v.Z,{icon:"mdi:close"})})]}),(0,l.jsx)(f.Z,{sx:{p:6},children:(0,l.jsxs)("form",{onSubmit:$(en),style:{paddingTop:8},children:[(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"firstName",control:Y,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{value:r,label:"First Name",onChange:s,error:Boolean(ee.firstName)})}}),ee.firstName&&(0,l.jsx)(C.Z,{sx:{color:"error.main"},children:ee.firstName.message})]}),(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"lastName",control:Y,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{value:r,label:"Last Name",onChange:s,error:Boolean(ee.lastName)})}}),ee.lastName&&(0,l.jsx)(C.Z,{sx:{color:"error.main"},children:ee.lastName.message})]}),(0,l.jsxs)(c.ZP,{container:!0,spacing:6,children:[(0,l.jsx)(c.ZP,{item:!0,md:6,sm:12,children:(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"email",control:Y,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"email",value:r,label:"Email",onChange:s,error:Boolean(ee.email)})}}),ee.email&&(0,l.jsx)(C.Z,{sx:{color:"error.main"},children:ee.email.message})]})}),(0,l.jsx)(c.ZP,{item:!0,md:6,sm:12,children:(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"phone",control:Y,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"string",label:"Phone",value:r,onChange:s,error:Boolean(ee.phone)})}}),ee.phone&&(0,l.jsx)(C.Z,{sx:{color:"error.main"},children:ee.phone.message})]})})]}),(0,l.jsxs)(c.ZP,{container:!0,spacing:6,children:[(0,l.jsx)(c.ZP,{item:!0,md:6,sm:12,children:(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"corpName",control:Y,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{value:r,label:"Corp Name",onChange:s,placeholder:"ANZ MIGRATE",error:Boolean(ee.corpName)})}}),ee.corpName&&(0,l.jsx)(C.Z,{sx:{color:"error.main"},children:ee.corpName.message})]})}),(0,l.jsx)(c.ZP,{item:!0,md:6,sm:12,children:(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"balance",control:Y,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"number",value:r,label:"Credit",onChange:s,placeholder:"100",error:Boolean(ee.balance)})}}),ee.balance&&(0,l.jsx)(C.Z,{sx:{color:"error.main"},children:ee.balance.message})]})}),(0,l.jsx)(c.ZP,{item:!0,md:6,sm:12,children:(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"address",control:Y,render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{value:r,label:"Address",onChange:s,error:Boolean(ee.address)})}}),ee.address&&(0,l.jsx)(C.Z,{sx:{color:"error.main"},children:ee.address.message})]})}),(0,l.jsx)(c.ZP,{item:!0,md:6,sm:12,children:(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(N.Z,{children:"Category"}),(0,l.jsx)(w.Qr,{name:"category",control:Y,render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsxs)(y.Z,{value:r,label:"Category",onChange:s,error:Boolean(ee.category),children:[(0,l.jsx)(t.Z,{value:"",children:"Please select"}),A.map((e,r)=>(0,l.jsx)(t.Z,{value:e._id,children:e.name},r))]})}}),ee.category&&(0,l.jsx)(C.Z,{sx:{color:"error.main"},children:ee.category.message})]})})]}),(0,l.jsx)(b.Z,{fullWidth:!0,sx:{mb:6},children:(0,l.jsx)(w.Qr,{name:"password",control:Y,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"text",label:"Password",value:r,onChange:s})}})}),(0,l.jsxs)(u.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:[(0,l.jsx)(Z.Z,{type:"submit",variant:"contained",color:"primary",size:"large",startIcon:(0,l.jsx)(v.Z,{icon:"mdi:content-save"}),sx:{mr:4},children:"Update"}),(0,l.jsx)(Z.Z,{variant:"contained",color:"error",size:"large",startIcon:(0,l.jsx)(v.Z,{icon:"mdi:delete"}),onClick:()=>L(!1),children:"Cancel"})]})]})})]})]})};Q.getLayout=e=>(0,l.jsx)(_.Z,{children:e}),r.default=Q}},function(e){e.O(0,[6284,8480,4583,8515,8259,7836,9072,9491,9317,7985,4314,9774,2888,179],function(){return e(e.s=47386)}),_N_E=e.O()}]);